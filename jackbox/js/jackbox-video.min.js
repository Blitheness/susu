(function(a){function oa(){fa.attr({width:k.width(),height:k.height()})}function pa(){ga=k.width();y=ga-237+L;M&&(p.css("width",y),D.css("width",y),W());g.width(ga);g.height(k.height())}function qa(b){g=a("<video />").addClass("cj-video");c=g[0];a("<source />").attr("type","video/webm").attr("src",b+".webm").prependTo(g);a("<source />").attr("type","video/mp4").attr("src",b+".mp4").prependTo(g)}function X(b,a){0!==b?(a&&(t.show(),u.hide()),t.hide(),u.show(),v.data("isOn",!0)):(a&&(u.show(),t.hide()), u.hide(),t.show(),v.data("isOn",!1),E&&l.css("width",0))}function ra(b){b&&b.stopPropagation();c.removeEventListener("canplay",ra,!1);c.pause();F=a(".cj-vid-full");q=a(".cj-vid-play");m=a(".cj-vid-pause");t=a(".cj-vid-mute");D=a(".cj-vid-total");G=a(".cj-vid-normal");u=a(".cj-vid-volume");p=a(".cj-vid-lines");H=a(".cj-vid-time");z=a(".cj-vid-progress");N=a(".cj-vid-vol-total");l=a(".cj-vid-vol-current");v=a(".cj-vid-vol-buttons");A=a(".cj-vid-vol-lines");O=a(".cj-vid-fullscreen");P=a(".cj-vid-play-pause"); r=a("<span />").addClass("cj-vid-play-btn").appendTo(h);I=P.length&&q.length&&m.length;ha=v.length&&u.length&&t.length;E=A.length&&l.length&&N.length;sa=O.length&&F.length&&G.length;M=p.length&&z.length&&D.length;Q=H.length;I?(Y?(q.hide(),m.show()):(m.hide(),q.show()),P.click(Z)):P.length?P.hide():(q.length&&q.hide(),m.length&&m.hide());ha?(X(s,!0),v.click(Ca)):v.length?v.hide():(u.length&&u.hide(),t.length&&t.hide());E?(ta=parseInt(A.css("padding-left"),10)||9,ia=parseInt(N.css("width"),10)||55, l.css("width",ia*s),A.click(Da)):(E=!1,A.length?A.hide():(l.length&&l.hide(),N.length&&N.hide()));sa&&("webkitSupportsFullscreen"in c||"mozFullScreenEnabled"in f)?(O.click(Ea),R=!1,L=0):(L=22,O.length?O.hide():(F.length&&F.hide(),G.length&&G.hide()));M?(p.css("width",y+L),D.css("width",y+L),z.css("width",0),p.click(Fa)):p.length?p.hide():(z.length&&z.hide(),D.length&&D.hide());Q&&(d=c.duration/60,w=parseInt(60*(d-parseInt(d,10)),10),d=parseInt(d,10),S="/"+(10>d?"0"+d:d)+":"+(10>w?"0"+w:w),H.text("00:00"+ S));T=!1;c.addEventListener("ended",Ga,!1);x.mouseenter(Ha).mouseleave(Ia);g.click(Z);r.click(Z);J=!1;c.pause();c.volume=s;parent.hasOwnProperty("jackboxFrameReady")?(aa=!0,parent.jackboxFrameReady()):a.jackboxVideo.fullyLoaded()}function Ja(){c.play()}function ua(){J=!0;null!==e&&clearTimeout(e);e=setTimeout(U,3E3);h.mousemove(ba).mouseleave(U)}function Ha(){T=!0}function Ia(){T=!1}function ba(b){b&&b.stopPropagation();null!==e&&clearTimeout(e);B?x.css("opacity",1):x.animate({opacity:1},300);if(C&& !T&&J&&(!R||ja))e=setTimeout(U,3E3)}function U(){null!==e&&clearTimeout(e);B?x.css("opacity",0):x.animate({opacity:0},300)}function Ga(b){b.stopPropagation();null!==j&&(clearInterval(j),j=null);null!==e&&(clearTimeout(e),e=null);null!==n&&(clearTimeout(n),n=null);c.pause();J=!1;c.currentTime=0;H.text("00:00"+S);h.unbind("mousemove",ba).unbind("mouseleave",U);M&&z.css("width",0);I&&(m.hide(),q.show());B?(x.css("opacity",1),r.css({cursor:"pointer",opacity:1})):(x.animate({opacity:1},300),r.css("cursor", "pointer").animate({opacity:1},300))}function Z(){c.paused?(c.play(),I&&(q.hide(),m.show()),J||ua(),M&&(j=setInterval(W,250)),B?r.css({cursor:"auto",opacity:0}):r.css("cursor","auto").animate({opacity:0},300)):(c.pause(),I&&(m.hide(),q.show()),null!==j&&(clearInterval(j),j=null),B?r.css({cursor:"pointer",opacity:1}):r.css("cursor","pointer").animate({opacity:1},300));ba()}function Da(b){b.stopPropagation();b=b.pageX-A.offset().left-ta;var a=b/ia;l.css("width",b);c.volume=a;ha&&X(a,!1)}function Ca(){v.data("isOn")? (E&&(va=parseInt(l.css("width"),10),l.css("width",0)),ka=c.volume,c.volume=0,X(0,!1)):(E&&l.css("width",va),c.volume=ka,X(1,!1))}function Fa(a){a.stopPropagation();null!==j&&(clearInterval(j),j=null);null===la&&(la=parseInt(p.css("padding-left"),10));c.pause();c.currentTime=c.duration*((a.pageX-p.offset().left-la)/y);W();Z()}function W(){wa=c.currentTime/c.duration;z.css("width",y*wa|0);Q&&(d=c.currentTime/60,w=parseInt(60*(d-parseInt(d,10)),10),d=parseInt(d,10),H.text((10>d?"0"+d:d)+":"+(10>w?"0"+ w:w)+S))}function Ka(){R=!1;n=null}function Ea(){C?ca():f.mozFullScreenEnabled?(f.addEventListener("mozfullscreenchange",xa,!1),h[0].mozRequestFullScreen()):c.webkitSupportsFullscreen&&(null!==n&&clearTimeout(n),R=!0,n=setTimeout(Ka,4E3),f.addEventListener("webkitfullscreenchange",da,!1),h[0].webkitRequestFullScreen());C=!C}function xa(){f.mozFullScreen?(C=!0,ya()):ca(!0)}function da(){f.webkitIsFullScreen?(f.removeEventListener("webkitfullscreenchange",da,!1),C=!0,setTimeout(ya,50)):ca(!0)}function ya(){F.hide(); G.show();ba();T=!1;k.off("resize.cj").on("resize.cj",La);c.webkitSupportsFullscreen&&f.addEventListener("webkitfullscreenchange",da,!1)}function La(){k.off("resize.cj");ca()}function ca(a){if(f.mozFullScreenEnabled){f.removeEventListener("mozfullscreenchange",xa,!1);if(a)return;f.mozCancelFullScreen()}else c.webkitSupportsFullscreen&&(f.removeEventListener("webkitfullscreenchange",da,!1),null!==n&&(clearTimeout(n),R=!1,n=null),a||f.webkitCancelFullScreen());F.show();G.hide();C=!1;J&&U()}var s=75, la=null,fa=null,C=!1,n=null,e=null,j=null,ja=!1,I,E,J,R,H,T,B,h,S,ha,P,ta,va,ka,Q,ma,L,x,p,z,A,O,N,ia,ga,M,aa,za,g,r,sa,t,u,V,Aa,y,Ba,D,l,v,G,na,c,wa,m,K,Y,d,w,q,F,k,ea,f;a.jackboxVideo=function(){"undefined"!==typeof Modernizr?(V=Modernizr.touch,ma=Modernizr.video,B=Modernizr.csstransitions):ma=V=B=!1;f=document;k=a(window);a(f);Ba=a("body");K=navigator.userAgent.toLowerCase();h=a("<div />").addClass("cj-video-container").appendTo(Ba);s*=0.01;ja=-1!==K.search("firefox");(na=-1!==K.search("msie"))&& (na=9>parseFloat(K.substr(K.indexOf("msie")+4)));var b=f.URL.split("?")[1],d=b.indexOf("poster="),e=b.substring(d+7,b.length);Y=-1!==b.search("autoplay=true")?!V?!0:!1:!1;ea=b.substring(b.indexOf("video=")+6,b.indexOf("&autoplay")).split(".mp4")[0];ma&&"false"===b.substring(b.indexOf("flashing=")+9,b.indexOf("&width"))&&!na?(qa(ea),V?("false"!==e&&g.attr("poster",e),g.attr("controls","controls").prependTo(h),parent.hasOwnProperty("jackboxFrameReady")?(aa=!0,parent.jackboxFrameReady()):a.jackboxVideo.fullyLoaded()): (x=a("<div />").addClass("cj-vid-controls").html('<div class="cj-vid-play-pause"><span class="cj-vid-play"></span><span class="cj-vid-pause"></span></div><div class="cj-vid-time">00:00/00:00</div><div class="cj-vid-lines"><span class="cj-vid-total"></span><span class="cj-vid-progress"></span></div><div class="cj-vid-vol-buttons"><span class="cj-vid-volume"></span><span class="cj-vid-mute"></span></div><div class="cj-vid-vol-lines"><span class="cj-vid-vol-total"></span><span class="cj-vid-vol-current"></span></div><div class="cj-vid-fullscreen"><span class="cj-vid-full"></span><span class="cj-vid-normal"></span></div>').appendTo(h), g.prependTo(h),c.volume=0,0===s&&(s=1),ka=s,c.addEventListener("canplay",ra,!1),c.play())):V?(qa(ea),"false"!==e&&g.attr("poster",e),g.attr("controls","controls").prependTo(h),parent.hasOwnProperty("jackboxFrameReady")?(aa=!0,parent.jackboxFrameReady()):a.jackboxVideo.fullyLoaded()):(e=b.indexOf("height="),Aa=b.substring(b.indexOf("width=")+6,e),za=b.substring(e+7,d),"jackboxFrameReady"in parent?parent.jackboxFrameReady(!0):a.jackboxVideo.fullyLoaded())};a.jackboxVideo.videoReady=function(){oa(); k.resize(oa);try{(-1===K.search("msie")?f.myflash:k[0].myflash).videoResized()}catch(a){}h.css("background-image","none");g.css("opacity",1)};a.jackboxVideo.fullyLoaded=function(){g?(pa(),k.resize(pa),h.css("background-image","none"),g.css("visibility","visible"),Q&&H.text("00:00"+S),aa&&ja&&h.addClass("cj-video-fix"),Y&&(setTimeout(Ja,100),Q&&(j=setInterval(W,250)),ua(),r.css({cursor:"auto",opacity:0}),I&&m.show())):(fa=a('<object id="myflash" type="application/x-shockwave-flash" data="../swf/video_fallback.swf" width="640" height="360"><param name="movie" value="../swf/video_fallback.swf" /><param name="allowScriptAccess" value="always" /><param name="bgcolor" value="#000000" /><param name="allowfullscreen" value="true" /><param name="wmode" value="transparent" /><param name="flashvars" value="url='+ ea+".mp4&vol="+s+"&auto="+Y+"&width="+Aa+"&height="+za+'" /></object>'),g=a("<div />").css("opacity",0).prependTo(h).append(fa))};a(document).ready(function(){a.jackboxVideo()})})(jQuery);function videoReady(){$.jackboxVideo.videoReady()}function cjInit(){$.jackboxVideo.fullyLoaded()};